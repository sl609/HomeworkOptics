% Take the data from Montecarlo simulation


data=[8.7220E-05
  4.3575E-04
  3.4840E-04
  2.3577E-04
  4.9820E-04
  3.0822E-04
  3.0070E-04
  1.5577E-04
  2.1771E-04
  2.9673E-04
  3.2580E-04
  3.0979E-04
  2.5452E-04
  3.6910E-04
  2.6057E-04
  3.1424E-04
  2.5027E-04
  2.4002E-04
  3.4301E-04
  2.9018E-04
  3.3265E-04
  3.0196E-04
  2.6734E-04
  2.8364E-04
  2.1462E-04
  2.5729E-04
  3.0083E-04
  2.6600E-04
  2.8631E-04
  3.6133E-04
  2.7492E-04
  3.1039E-04
  3.0124E-04
  2.6695E-04
  2.7293E-04
  3.3651E-04
  2.8908E-04
  3.2638E-04
  3.1444E-04
  2.8841E-04
  3.1478E-04
  2.8562E-04
  2.6417E-04
  3.0538E-04
  3.2463E-04
  2.8713E-04
  2.9789E-04
  2.5775E-04
  2.9590E-04
  3.6497E-04
  3.4332E-04
  3.3116E-04
  3.2527E-04
  2.8495E-04
  3.4643E-04
  3.3805E-04
  3.1517E-04
  3.5003E-04
  3.5244E-04
  3.1278E-04
  3.0253E-04
  3.4308E-04
  2.9309E-04
  2.8411E-04
  3.4959E-04
  3.1048E-04
  3.5166E-04
  3.0215E-04
  3.0540E-04
  3.7976E-04
  2.9623E-04
  3.6263E-04
  3.1077E-04
  3.0710E-04
  3.3167E-04
  3.6637E-04
  3.3967E-04
  3.7771E-04
  3.5539E-04
  2.9510E-04
  3.5970E-04
  3.0915E-04
  3.1829E-04
  3.6893E-04
  3.5945E-04
  3.5869E-04
  3.4900E-04
  3.5493E-04
  3.4750E-04
  3.0907E-04
  3.8099E-04
  3.5598E-04
  3.8230E-04
  3.4663E-04
  3.8292E-04
  4.1159E-04
  3.5700E-04
  3.6950E-04
  3.8859E-04
  3.4297E-04
  3.7227E-04
  3.4384E-04
  3.5959E-04
  3.7577E-04
  3.6328E-04
  4.0706E-04
  4.0331E-04
  4.0343E-04
  3.9477E-04
  4.6150E-04
  4.1854E-04
  4.1592E-04
  3.5768E-04
  4.0691E-04
  4.3057E-04
  4.4083E-04
  4.1627E-04
  4.2388E-04
  4.1378E-04
  4.0290E-04
  4.0611E-04
  4.1516E-04
  4.4214E-04
  4.4052E-04
  4.3816E-04
  4.6556E-04
  4.1113E-04
  4.3199E-04
  4.4648E-04
  4.6653E-04
  4.7723E-04
  4.5342E-04
  3.9812E-04
  4.4425E-04
  4.6095E-04
  4.5067E-04
  4.5797E-04
  4.5637E-04
  4.3822E-04
  4.5731E-04
  4.7616E-04
  4.6038E-04
  4.5214E-04
  4.5258E-04
  5.0116E-04
  4.4680E-04
  4.9720E-04
  4.4997E-04
  4.7715E-04
  4.4900E-04
  5.0025E-04
  5.1106E-04
  4.6670E-04
  5.1878E-04
  5.2507E-04
  4.6590E-04
  4.8397E-04
  5.2272E-04
  4.9520E-04
  5.4186E-04
  5.4082E-04
  5.7491E-04
  5.1659E-04
  5.0413E-04
  5.3505E-04
  5.3053E-04
  4.7829E-04
  5.0934E-04
  5.3792E-04
  5.3348E-04
  5.4382E-04
  5.3485E-04
  6.0843E-04
  5.7885E-04
  5.3321E-04
  5.6258E-04
  5.8304E-04
  5.5338E-04
  5.9182E-04
  5.7833E-04
  6.1857E-04
  5.8710E-04
  5.7685E-04
  5.8909E-04
  6.0635E-04
  6.2876E-04
  6.3805E-04
  6.6699E-04
  6.2507E-04
  6.2470E-04
  6.3002E-04
  6.6504E-04
  5.9098E-04
  6.6261E-04
  6.1792E-04
  6.8531E-04
  6.4843E-04
  6.8135E-04
  6.7462E-04
  7.0866E-04
  6.5806E-04
  6.5698E-04
  7.2421E-04
  6.6883E-04
  6.5529E-04
  6.7985E-04
  7.0996E-04
  6.7490E-04
  7.3611E-04
  7.5176E-04
  7.4711E-04
  7.3091E-04
  7.6226E-04
  7.7425E-04
  7.7793E-04
  7.2701E-04
  7.6208E-04
  7.9864E-04
  8.0102E-04
  7.6187E-04
  7.8344E-04
  8.4844E-04
  7.7038E-04
  8.1293E-04
  8.0175E-04
  8.0549E-04
  8.6996E-04
  8.3220E-04
  8.3255E-04
  8.5520E-04
  8.3077E-04
  8.6458E-04
  9.1378E-04
  9.0739E-04
  9.1474E-04
  8.4598E-04
  8.5304E-04
  8.9102E-04
  9.2821E-04
  9.1608E-04
  9.4236E-04
  9.6820E-04
  1.0098E-03
  9.8492E-04
  9.8324E-04
  9.6214E-04
  9.4354E-04
  9.5641E-04
  1.0172E-03
  9.9788E-04
  1.0343E-03
  1.0313E-03
  1.0207E-03
  1.0370E-03
  1.0297E-03
  1.0294E-03
  1.0702E-03
  1.0158E-03
  1.0994E-03
  1.1039E-03
  1.1196E-03
  1.1321E-03
  1.2113E-03
  1.1507E-03
  1.1084E-03
  1.1113E-03
  1.1282E-03
  1.1619E-03
  1.2096E-03
  1.1720E-03
  1.1910E-03
  1.2471E-03
  1.2171E-03
  1.2693E-03
  1.2467E-03
  1.2082E-03
  1.2339E-03
  1.2425E-03
  1.3080E-03
  1.2792E-03
  1.3210E-03
  1.3533E-03
  1.3434E-03
  1.3248E-03
  1.3605E-03
  1.4117E-03
  1.3684E-03
  1.3522E-03
  1.3939E-03
  1.4035E-03
  1.4280E-03
  1.4263E-03
  1.4307E-03
  1.5012E-03
  1.5443E-03
  1.5398E-03
  1.4996E-03
  1.5107E-03
  1.5288E-03
  1.5531E-03
  1.5626E-03
  1.5610E-03
  1.6187E-03
  1.6417E-03
  1.5505E-03
  1.6015E-03
  1.7141E-03
  1.6744E-03
  1.6212E-03
  1.7101E-03
  1.6607E-03
  1.6822E-03
  1.6661E-03
  1.7254E-03
  1.7927E-03
  1.8343E-03
  1.8307E-03
  1.7487E-03
  1.8193E-03
  1.8813E-03
  1.8688E-03
  1.9708E-03
  1.9622E-03
  1.8727E-03
  1.9886E-03
  2.0278E-03
  1.9718E-03
  2.0151E-03
  2.0648E-03
  2.0236E-03
  2.1323E-03
  2.0761E-03
  2.0766E-03
  2.0787E-03
  2.1754E-03
  2.1335E-03
  2.2041E-03
  2.2343E-03
  2.3020E-03
  2.2334E-03
  2.2601E-03
  2.2855E-03
  2.3453E-03
  2.3810E-03
  2.3741E-03
  2.4108E-03
  2.4397E-03
  2.5487E-03
  2.4402E-03
  2.5559E-03
  2.5296E-03
  2.4837E-03
  2.6120E-03
  2.6395E-03
  2.6775E-03
  2.6168E-03
  2.6746E-03
  2.7051E-03
  2.8007E-03
  2.7345E-03
  2.8017E-03
  2.6954E-03
  2.8920E-03
  2.8119E-03
  2.9205E-03
  2.9691E-03
  2.9508E-03
  2.9985E-03
  3.0309E-03
  2.9812E-03
  3.0637E-03
  3.1477E-03
  3.0901E-03
  3.1270E-03
  3.1625E-03
  3.1375E-03
  3.3300E-03
  3.2836E-03
  3.2806E-03
  3.4227E-03
  3.3572E-03
  3.4173E-03
  3.4885E-03
  3.5503E-03
  3.4612E-03
  3.5598E-03
  3.6262E-03
  3.6481E-03
  3.7078E-03
  3.7162E-03
  3.7967E-03
  3.8585E-03
  3.7623E-03
  3.7426E-03
  3.8765E-03
  3.9544E-03
  4.0101E-03
  4.0963E-03
  4.1740E-03
  4.1801E-03
  4.1220E-03
  4.1055E-03
  4.1258E-03
  4.4198E-03
  4.3643E-03
  4.3912E-03
  4.3209E-03
  4.3932E-03
  4.4986E-03
  4.6767E-03
  4.6103E-03
  4.6577E-03
  4.8328E-03
  4.8072E-03
  4.9022E-03
  4.9727E-03
  5.0504E-03
  4.9744E-03
  4.9804E-03
  5.0685E-03
  5.2780E-03
  5.0677E-03
  5.3484E-03
  5.3138E-03
  5.3378E-03
  5.5321E-03
  5.5263E-03
  5.6418E-03
  5.6539E-03
  5.7803E-03
  5.8524E-03
  5.8020E-03
  5.9515E-03
  5.9438E-03
  6.0838E-03
  5.8776E-03
  6.0677E-03
  6.1224E-03
  6.3233E-03
  6.3263E-03
  6.2449E-03
  6.5107E-03
  6.6070E-03
  6.6525E-03
  6.6265E-03
  6.8356E-03
  6.8972E-03
  6.9967E-03
  7.0776E-03
  7.1661E-03
  7.2585E-03
  7.2165E-03
  7.1912E-03
  7.4865E-03
  7.6010E-03
  7.5782E-03
  7.7214E-03
  7.9872E-03
  7.9670E-03
  7.9857E-03
  8.1881E-03
  8.1379E-03
  8.2643E-03
  8.4450E-03
  8.4919E-03
  8.6958E-03
  8.5496E-03
  8.9609E-03
  8.9078E-03
  8.9781E-03
  9.2401E-03
  9.2390E-03
  9.3783E-03
  9.4795E-03
  9.8571E-03
  9.7707E-03
  1.0008E-02
  1.0026E-02
  1.0289E-02
  1.0491E-02
  1.0498E-02
  1.0679E-02
  1.0957E-02
  1.1218E-02
  1.1189E-02
  1.1490E-02
  1.1585E-02
  1.1995E-02
  1.1941E-02
  1.2395E-02
  1.2551E-02
  1.2891E-02
  1.3114E-02
  1.3225E-02
  1.3818E-02
  1.4424E-02
  1.4799E-02
  1.5553E-02
  1.6196E-02
  1.8281E-02
  3.9426E-02
  3.6600E-02
  3.4985E-02
  3.4084E-02
  3.3308E-02
  3.3161E-02
  3.1945E-02
  3.1469E-02
  3.0873E-02
  3.0774E-02
  3.0250E-02
  2.9827E-02
  2.9904E-02
  2.8843E-02
  2.8548E-02
  2.8233E-02
  2.8307E-02
  2.7785E-02
  2.7675E-02
  2.7281E-02
  2.7051E-02
  2.6691E-02
  2.6412E-02
  2.5892E-02
  2.5763E-02
  2.5356E-02
  2.5561E-02
  2.5109E-02
  2.4654E-02
  2.4180E-02
  2.3854E-02
  2.3860E-02
  2.3746E-02
  2.3254E-02
  2.3177E-02
  2.2967E-02
  2.2785E-02
  2.2374E-02
  2.2007E-02
  2.1572E-02
  2.1714E-02
  2.1417E-02
  2.1019E-02
  2.0763E-02
  2.0722E-02
  2.0119E-02
  2.0060E-02
  1.9978E-02
  1.9435E-02
  1.9409E-02
  1.9128E-02
  1.8635E-02
  1.8870E-02
  1.8480E-02
  1.8079E-02
  1.7877E-02
  1.7909E-02
  1.7608E-02
  1.7209E-02
  1.7117E-02
  1.7157E-02
  1.6724E-02
  1.6584E-02
  1.6489E-02
  1.6107E-02
  1.6056E-02
  1.5534E-02
  1.5459E-02
  1.5226E-02
  1.5181E-02
  1.4759E-02
  1.4851E-02
  1.4715E-02
  1.4331E-02
  1.4263E-02
  1.4082E-02
  1.3907E-02
  1.3707E-02
  1.3589E-02
  1.3509E-02
  1.3198E-02
  1.2944E-02
  1.2720E-02
  1.2851E-02
  1.2358E-02
  1.2434E-02
  1.2134E-02
  1.2121E-02
  1.1916E-02
  1.1849E-02
  1.1721E-02
  1.1410E-02
  1.1454E-02
  1.1083E-02
  1.1229E-02
  1.0928E-02
  1.0868E-02
  1.0583E-02
  1.0455E-02
  1.0401E-02
  1.0134E-02
  1.0076E-02
  1.0106E-02
  9.6988E-03
  9.7495E-03
  9.4918E-03
  9.5221E-03
  9.1809E-03
  9.2144E-03
  8.9902E-03
  9.0193E-03
  8.9812E-03
  8.8312E-03
  8.5313E-03
  8.4817E-03
  8.4670E-03
  8.4246E-03
  8.2135E-03
  8.0558E-03
  7.9253E-03
  7.7857E-03
  7.7776E-03
  7.6402E-03
  7.4986E-03
  7.3934E-03
  7.4343E-03
  7.3923E-03
  7.2746E-03
  7.1320E-03
  7.0088E-03
  6.9907E-03
  6.8862E-03
  6.7607E-03
  6.6357E-03
  6.5609E-03
  6.5403E-03
  6.4758E-03
  6.3658E-03
  6.2528E-03
  6.0976E-03
  6.1684E-03
  6.1254E-03
  6.0035E-03
  5.8651E-03
  5.7926E-03
  5.7577E-03
  5.6515E-03
  5.4418E-03
  5.4680E-03
  5.4873E-03
  5.3334E-03
  5.2280E-03
  5.2993E-03
  5.1074E-03
  5.1136E-03
  5.0571E-03
  4.9312E-03
  4.9577E-03
  4.8454E-03
  4.7898E-03
  4.7259E-03
  4.6366E-03
  4.7032E-03
  4.6854E-03
  4.4808E-03
  4.4254E-03
  4.3722E-03
  4.3529E-03
  4.2859E-03
  4.1981E-03
  4.2098E-03
  4.1188E-03
  4.0590E-03
  3.9854E-03
  4.0388E-03
  3.8661E-03
  3.8357E-03
  3.8037E-03
  3.7147E-03
  3.7013E-03
  3.6724E-03
  3.6252E-03
  3.6421E-03
  3.5023E-03
  3.5101E-03
  3.4303E-03
  3.4440E-03
  3.3538E-03
  3.3814E-03
  3.3884E-03
  3.2617E-03
  3.1654E-03
  3.2054E-03
  3.0473E-03
  3.0158E-03
  3.0397E-03
  3.0241E-03
  3.0213E-03
  2.9389E-03
  2.9539E-03
  2.8885E-03
  2.9127E-03
  2.7988E-03
  2.8201E-03
  2.6942E-03
  2.6702E-03
  2.7178E-03
  2.6719E-03
  2.5838E-03
  2.5254E-03
  2.5463E-03
  2.5489E-03
  2.4984E-03
  2.4656E-03
  2.4387E-03
  2.3537E-03
  2.3795E-03
  2.3065E-03
  2.3233E-03
  2.3287E-03
  2.2826E-03
  2.2176E-03
  2.2329E-03
  2.2021E-03
  2.1417E-03
  2.1117E-03
  2.0622E-03
  2.0992E-03
  2.0197E-03
  1.9986E-03
  1.9846E-03
  1.9772E-03
  1.9350E-03
  1.8785E-03
  1.9231E-03
  1.8559E-03
  1.8860E-03
  1.8674E-03
  1.8324E-03
  1.8259E-03
  1.7519E-03
  1.7573E-03
  1.7429E-03
  1.7077E-03
  1.7030E-03
  1.6896E-03
  1.6616E-03
  1.6086E-03
  1.6355E-03
  1.5695E-03
  1.5559E-03
  1.5459E-03
  1.5168E-03
  1.5029E-03
  1.5216E-03
  1.4783E-03
  1.4577E-03
  1.4759E-03
  1.4252E-03
  1.4555E-03
  1.3693E-03
  1.3918E-03
  1.3681E-03
  1.3461E-03
  1.3692E-03
  1.3015E-03
  1.3224E-03
  1.2750E-03
  1.2870E-03
  1.2801E-03
  1.2120E-03
  1.2356E-03
  1.2045E-03
  1.1572E-03
  1.1795E-03
  1.1652E-03
  1.1689E-03
  1.1042E-03
  1.1334E-03
  1.1475E-03
  1.1359E-03
  1.1149E-03
  1.0963E-03
  1.0877E-03
  1.0534E-03
  1.0590E-03
  1.0201E-03
  1.0236E-03
  1.0116E-03
  9.7511E-04
  1.0042E-03
  9.8513E-04
  9.7049E-04
  9.3868E-04
  9.4444E-04
  9.2704E-04
  9.3263E-04
  9.3704E-04
  9.3221E-04
  9.0095E-04
  8.6300E-04
  8.4538E-04
  8.3897E-04
  8.5054E-04
  8.5553E-04
  8.1609E-04
  8.1688E-04
  7.9626E-04
  7.9681E-04
  7.8108E-04
  7.9675E-04
  7.7640E-04
  7.6322E-04
  7.5218E-04
  7.5453E-04
  7.6223E-04
  7.0986E-04
  7.2149E-04
  7.1416E-04
  6.9548E-04
  6.9375E-04
  6.9686E-04
  6.6542E-04
  6.9509E-04
  6.6639E-04
  6.8076E-04
  6.5764E-04
  6.5784E-04
  6.6051E-04
  6.3548E-04
  6.0378E-04
  6.1938E-04
  6.2788E-04
  5.8906E-04
  6.0627E-04
  5.8185E-04
  5.9475E-04
  5.6283E-04
  5.6423E-04
  5.7026E-04
  5.4143E-04
  5.5449E-04
  5.4110E-04
  5.3004E-04
  5.3869E-04
  5.3516E-04
  5.2614E-04
  5.0830E-04
  4.9819E-04
  5.0503E-04
  4.9391E-04
  4.9838E-04
  4.8162E-04
  5.0431E-04
  4.8757E-04
  4.6097E-04
  4.7194E-04
  4.6232E-04
  4.5188E-04
  4.6660E-04
  4.6129E-04
  4.4710E-04
  4.3074E-04
  4.4471E-04
  4.3782E-04
  4.1570E-04
  4.0330E-04
  4.1398E-04
  4.1444E-04
  4.1832E-04
  3.8196E-04
  3.9361E-04
  3.9279E-04
  3.9659E-04
  3.8547E-04
  3.7391E-04
  3.6922E-04
  3.5283E-04
  3.7489E-04
  3.5131E-04
  3.6084E-04
  3.5935E-04
  3.4305E-04
  3.4237E-04
  3.3934E-04
  3.2746E-04
  3.3758E-04
  3.3160E-04
  3.3269E-04
  3.1606E-04
  3.2929E-04
  3.1382E-04
  3.1628E-04
  3.0177E-04
  3.0701E-04
  3.0871E-04
  3.1124E-04
  2.9165E-04
  2.9418E-04
  2.9620E-04
  2.8640E-04
  2.8617E-04
  2.8364E-04
  2.7702E-04
  2.7470E-04
  2.7610E-04
  2.6633E-04
  2.6893E-04
  2.7090E-04
  2.6268E-04
  2.5136E-04
  2.4500E-04
  2.5480E-04
  2.4378E-04
  2.5015E-04
  2.4659E-04
  2.5938E-04
  2.2589E-04
  2.2888E-04
  2.3873E-04
  2.2958E-04
  2.2758E-04
  2.2727E-04
  2.2795E-04
  2.2613E-04
  2.1573E-04
  2.2219E-04
  2.1915E-04
  2.1216E-04
  2.0748E-04
  2.1417E-04
  2.0533E-04
  1.9976E-04
  1.9544E-04
  1.9813E-04
  1.9639E-04
  1.8986E-04
  1.9577E-04
  1.9356E-04
  1.9324E-04
  1.8284E-04
  1.7806E-04
  1.9751E-04
  1.8810E-04
  1.8060E-04
  1.7469E-04
  1.7426E-04
  1.7345E-04
  1.7401E-04
  1.7286E-04
  1.6184E-04
  1.7035E-04
  1.6428E-04
  1.6042E-04
  1.6480E-04
  1.5110E-04
  1.6258E-04
  1.6040E-04
  1.5649E-04
  1.3987E-04
  1.5768E-04
  1.4450E-04
  1.4720E-04
  1.4511E-04
  1.4738E-04
  1.4820E-04
  1.4398E-04
  1.3907E-04
  1.3474E-04
  1.3447E-04
  1.3361E-04
  1.3339E-04
  1.3174E-04
  1.3385E-04
  1.2973E-04
  1.3243E-04
  1.2855E-04
  1.2781E-04
  1.2830E-04
  1.2355E-04
  1.1973E-04
  1.2768E-04
  1.2195E-04
  1.1458E-04
  1.2121E-04
  1.1420E-04
  1.1546E-04
  1.0946E-04
  1.0657E-04
  1.0885E-04
  1.0902E-04
  1.0393E-04
  1.0666E-04
  1.0455E-04
  1.0974E-04
  1.0420E-04
  1.0044E-04
  9.9547E-05
  1.0225E-04
  1.0960E-02];
% multiply by 10^2 to make it mW/cm^w
Cut_data=data(501-300:501+299)*10^2;
distance_p=linspace(0,1.5,300)
distance_n=linspace(-1.5,-1.5/300,300);
distance=[distance_n,distance_p]
middle_line=zeros(1,301);

for i = 1:301
    current_v=Cut_data(i);
    [v,x_position]=min(abs(Cut_data(302:600)-current_v));
    middle_line(i)=(distance(i)+distance(x_position+300))/2;

end

figure;
semilogy(distance,Cut_data)
hold on
plot([0,0],[0.1,10],'--')
plot(middle_line,Cut_data(1:301))
ylim([0.1,10])
xlabel('Horizontal position x (cm)');
ylabel('Diffse reflectance \itRd (mW/cm^2)');

